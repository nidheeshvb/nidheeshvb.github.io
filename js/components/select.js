import classes from"./variables/variables.js";function initializeCustomSelect(t){let n=t.querySelector("."+classes.SELECT_BOX),l=t.querySelector("."+classes.SELECT_INPUT),a=t.querySelector("."+classes.DROPDOWN),s=t.querySelector("."+classes.DROPDOWN_SEARCH),r=t.querySelector("."+classes.DROPDOWN_OPTIONS),c=t.querySelector("."+classes.SELECTED_TAGS),i="true"===t.dataset.multiple,e=l.textContent,o=[];function u(){var e="block"===a.style.display;a.style.display=e?"none":"block",n.setAttribute("aria-expanded",!e),e||s.focus()}function d(e){let n=e.target.value.toLowerCase();r.querySelectorAll("li").forEach(e=>{var t=e.textContent.toLowerCase();e.style.display=t.includes(n)?"":"none"})}function E(e){let t=e.getAttribute("data-value");e=e.textContent;(i?(o.includes(t)?o=o.filter(e=>e!==t):o.push(t),f):(o=[t],l.textContent=e,u))(),v(),y()}function v(){r.querySelectorAll("li").forEach(e=>{var t=e.getAttribute("data-value");e.setAttribute("aria-selected",o.includes(t)),e.classList.toggle(classes.SELECTED,o.includes(t))})}function f(){c.innerHTML="",o.forEach(e=>{var t=r.querySelector(`li[data-value="${e}"]`),n=document.createElement("div"),l=(n.className=classes.SELECTED_TAG,n.textContent=t.textContent,document.createElement("button"));l.textContent="x",l.setAttribute("aria-label","Remove "+t.textContent),l.addEventListener("click",()=>{return t=e,o=o.filter(e=>e!==t),f(),void v();var t}),n.appendChild(l),c.appendChild(n)}),y()}function y(){0===o.length?l.textContent=e:i&&(l.textContent=""),l.setAttribute("aria-label",`${o.length} option${1!==o.length?"s":""} selected`)}function m(e){var t=Array.from(r.querySelectorAll('li:not([style*="display: none"])')),n=t.findIndex(e=>e===document.activeElement);switch(e.key){case"ArrowDown":e.preventDefault(),n<t.length-1&&t[n+1].focus();break;case"ArrowUp":e.preventDefault(),0<n&&t[n-1].focus();break;case"Enter":case" ":e.preventDefault(),"LI"===document.activeElement.tagName?E(document.activeElement):document.activeElement===l&&u();break;case"Escape":u(),l.focus()}}n.addEventListener("click",u),s.addEventListener("input",d),r.querySelectorAll("li").forEach(e=>{e.addEventListener("click",()=>E(e))}),document.addEventListener("click",e=>{t.contains(e.target)||(a.style.display="none",n.setAttribute("aria-expanded","false"))}),t.addEventListener("keydown",m),y()}export{initializeCustomSelect};